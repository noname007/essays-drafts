title: 元表、元方法
tags: 
- lua
- 元表
- 元方法
date: 2015-09-18 17:47:00


---

{% blockquote %}
每一个值都有一个元表。table和userdata可以有各自独立的元表，其他类型的值则共享其类型所属的单一元表
{% endblockquote %}

表是lua中非常重要的基本数据类型，实现其他的一些编程技术概念的基础，如模块、包、类。通过语言提供的元表和元方法可以更改表的表现行为。

###☆ 元方法

|元方法|简单描述|
|---|---|
|`__metatable` | 调用 setmetatable、getmetatable方法的时候会用到这个字段|
|`__index`  |当表中的索引不存在时，查找元表中是否设置了这个元方法|
|`__newindex`   |同上|
| `__add`   |+|
| `__sub`   |-|
| `__mul`   |*|
| `__div`   |/|
| `__unm`   |-(相反数)|
| `__mod`   |%|
| `__pow`   |^|
| `__concat` | `..` 连接操作符|
| `__eq` |等于|
| `__lt` |小于|
| `__gt` |大于|
| `__metatable` |保护作用|
| `__tostring`  |字符串化|
 
总的来说，在程序中通过`元方法`，可以：
- 更改`算符运算符`、`关系运算符`作用于表时的行为
- 更改对表中的元素的访问行为，简单说是重载了，`[]` ,`[]=` 运算符

这两个特性在C++特性中看起来是`运算符的重载`。与C++相比，Lua本身没有面向对象的支持，但是使用元方法，可以实现其中的继承，还可以实现其他的功能、如返回具有默认值的table、跟踪table访问、只读的table

###☆ 继承

###☆ 返回具有默认值的table
###☆ 跟踪table访问
###☆只读的table

